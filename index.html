<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Entrar ou Cadastrar</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;700&display=swap');

    body {
      margin: 0;
      padding: 0;
      font-family: 'Barlow Condensed', sans-serif;
      background-color: #f8f9fa;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .form-container {
      background-color: #fff;
      border: 3px solid #7f9e7f;
      border-radius: 15px;
      padding: 30px 40px;
      width: 100%;
      max-width: 440px;
      text-align: center;
    }

    .form-container img.logo {
      width: 200px;
      height: 200px;
      object-fit: contain;
      margin-bottom: 15px;
    }

    .form-container h2 {
      color: #2f3d2f;
      margin-bottom: 20px;
    }

    .input-group {
      display: flex;
      align-items: center;
      background-color: #dce8d0;
      border: 2px solid #7f9e7f;
      border-radius: 8px;
      margin-bottom: 15px;
      padding: 8px 12px;
    }

    .input-group img {
      width: 24px;
      height: 24px;
      margin-right: 10px;
    }

    .input-group input {
      border: none;
      background: transparent;
      outline: none;
      flex: 1;
      font-size: 16px;
      color: #3d312f;
    }

    .form-button {
      background-color: #99d499;
      color: rgb(17, 7, 7);
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: background-color 0.3s;
    }

    .form-button:hover {
      background-color: #aadfaa;
    }

    .toggle-form {
      margin-top: 15px;
      font-size: 15px;
    }

    .toggle-form button {
      background: none;
      border: none;
      color: #4b664b;
      cursor: pointer;
      font-weight: bold;
      font-size: 15px;
    }

    .message {
      margin-top: 12px;
      font-size: 14px;
      color: #c04739;
    }
  </style>
</head>

<body>
  <div class="form-container">
    <img src="/img/logo.png" alt="Logo" class="logo">

    <!-- LOGIN FORM -->
    <form id="loginForm">
      <h2>Seja bem-vindo!</h2>
      <div class="input-group">
        <img src="/img/o-email.png" alt="Email">
        <input type="email" id="loginEmail" placeholder="E-mail" required />
      </div>
      <div class="input-group">
        <img src="/img/senha.png" alt="Senha">
        <input type="password" id="loginPassword" placeholder="Senha" required />
      </div>
      <button type="submit" class="form-button">Entrar</button>
      <p class="message" id="loginMessage"></p>
    </form>

    <!-- REGISTER FORM -->
    <form id="registerForm" style="display: none;">
      <h2>Cadastrar 🍀</h2>
      <div class="input-group">
        <img src="/img/usuário.png" alt="Nome">
        <input type="text" id="registerName" placeholder="Nome completo" required />
      </div>
      <div class="input-group">
        <img src="/img/o-email.png" alt="Email">
        <input type="email" id="registerEmail" placeholder="E-mail" required />
      </div>
      <div class="input-group">
        <img src="/img/senha.png" alt="Senha">
        <input type="password" id="registerPassword" placeholder="Senha" required />
      </div>
      <div class="input-group">
        <img src="/img/cidade.png" alt="Cidade">
        <input type="text" id="registerCity" placeholder="Cidade" required />
      </div>
      <div class="input-group">
        <img src="/img/estado.png" alt="Estado">
        <input type="text" id="registerState" placeholder="Estado" required />
      </div>
      <button type="submit" class="form-button">Cadastrar</button>
      <p class="message" id="registerMessage"></p>
      <div class="input-group">
        <img src="/img/foto-icon.png" alt="Ícone foto">
        <input type="file" id="fotoPerfil" accept="image/*" />
      </div>

    </form>

    <div class="toggle-form">
      <span id="toggleText">Não tem uma conta?</span>
      <button id="toggleButton">Cadastrar</button>
    </div>
  </div>

  <script>
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const toggleButton = document.getElementById('toggleButton');
    const toggleText = document.getElementById('toggleText');
    const loginMessage = document.getElementById('loginMessage');
    const registerMessage = document.getElementById('registerMessage');

    const users = [];

    toggleButton.addEventListener('click', () => {
      const isLogin = loginForm.style.display !== 'none';
      loginForm.style.display = isLogin ? 'none' : 'block';
      registerForm.style.display = isLogin ? 'block' : 'none';
      toggleButton.textContent = isLogin ? 'Entrar' : 'Cadastrar';
      toggleText.textContent = isLogin ? 'Já tem uma conta?' : 'Não tem uma conta?';
      loginMessage.textContent = '';
      registerMessage.textContent = '';
    });

    loginForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      const user = users.find(user => user.email === email && user.password === password);

      if (user) {
        loginMessage.style.color = '#2f7b32';
        loginMessage.textContent = 'Login bem-sucedido! Redirecionando...';
        setTimeout(() => {
          window.location.href = "/paginicial.html";
          // novo nome da sua página principal
        }, 1500);
      } else {
        loginMessage.style.color = '#c0392b';
        loginMessage.textContent = 'Credenciais inválidas.';  
      }
    });

    registerForm.addEventListener('submit', function (e) {
      e.preventDefault();
      const name = document.getElementById('registerName').value;
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const city = document.getElementById('registerCity').value;
      const state = document.getElementById('registerState').value;

      const exists = users.some(user => user.email === email);

      if (exists) {
        registerMessage.style.color = '#c0392b';
        registerMessage.textContent = 'E-mail já cadastrado.';
      } else {
        users.push({ name, email, password, city, state });
        registerMessage.style.color = '#2f7b32';
        registerMessage.textContent = 'Cadastro realizado com sucesso!';
        setTimeout(() => {
          toggleButton.click();
        }, 1500);
      }

      localStorage.setItem('userData', JSON.stringify({
        nome: name,
        email: email,
        cidade: city,
        estado: state,
        desde: "Março de 2024" // ou gere a data atual dinamicamente
      }));

      const file = document.getElementById('fotoPerfil').files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function () {
          salvarUsuario(reader.result);
        };
        reader.readAsDataURL(file);
      } else {
        salvarUsuario(null);
      }

      function salvarUsuario(fotoBase64) {
        localStorage.setItem('userData', JSON.stringify({
          nome: name,
          email: email,
          cidade: city,
          estado: state,
          desde: "Março de 2024",
          foto: fotoBase64
        }));
        registerMessage.style.color = '#2f7b32';
        registerMessage.textContent = 'Cadastro realizado com sucesso!';
        setTimeout(() => {
          toggleButton.click(); // volta pro login
        }, 1500);
      }


    });
  </script>
</body>

</html>